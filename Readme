1. About
========
youtube_cache.py is a squid redirector written in python which caches youtube
videos on proxy for serving the subsequent requests. It caches the videos
without disturbing the caching policies for other dynamic content.

2. Requires
===========
1. squid
2. httpd ( Apache ) or any other webserver
3. python

3. Installation & Configuration
===============================
Assuming you have squid and apache installed. The following configurations are
required to get it running. Newbies are instructed to stick with default configuration
as much as possible otherwise you'll be lost in directory permissions.

3.1 Configuring global configurations
=====================================
Config File is /etc/sysconfig/youtube_cache.conf
# Directory where the cached videos will be stored.
cachedir = /var/spool/squid/youtube
# Cache url where requests from cached videos will be redirected
# Example : http://localhost.localdomain/youtube
# or http://proxy.example.com/youtube/
# or http://192.168.36.204/youtube
cacheurl = http://<Proxy_Server_IP_OR_Domain>/youtube/
# File where youtube cache log will be stored.
logfile = /var/spool/squid/youtube/youtube.log
# Proxy for http content
http_proxy = http://<Proxy_Server_IP_OR_Domain>:<Proxy_port>/

3.2 Creating directories and setting permissions
================================================
Make sure apache has read permission to the cache_dir. The permissions for cache_dir
(and it parent directories) should be 711. Also make sure cache_dir is writable by
user squid. If you are using the default cache_dir, following steps will be enough
for everything to be right.
[root@proxy root]# cd /var/spool/
[root@proxy spool]# chmod 751 squid
[root@proxy spool]# cd squid
[root@proxy squid]# mkdir youtube
[root@proxy squid]# chown squid:squid youtube
[root@proxy squid]# chmod 755 youtube

3.3 Configuring Apache
======================
Move the youtube.conf file to /etc/httpd/conf.d/, edit it accordingly and reload the
httpd service using
[root@proxy root]# service httpd reload

3.3 Configuring squid
=====================
Store youtube_cache.py at any place you want. For this tutorial we assume you
store it in /etc/squid/ . Make changes to the steps below depending on where
you store the script.

Add the two lines below to your squid.conf which is generally found in
/etc/squid/squid.conf .

#### BEGIN Add to squid.conf ####
redirect_program /usr/bin/python /etc/squid/youtube_cache.py
redirect_children 10
#### END Add to squid.conf ####

Save squid.conf and reload the squid service using
[root@proxy root]# service squid reload

4. Bugs, Suggestions, Comments
===========================
Mail them to Kulbir Saini <kulbirsaini@students.iiit.ac.in>

5. Online Help
===========
1. How to configure squid http://fedora.co.in/content/how-configure-squid-proxy-server
2. How to write custorm squid redirector in python http://fedora.co.in/content/writing-custom-redirector-plugin-squid-python
